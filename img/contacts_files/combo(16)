YUI.add("global-nav-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var n,r;typeof t.enableBrowserUpgradeBanner=="undefined"&&(t.enableBrowserUpgradeBanner=!0),this.set("showBrowserUpgradeBanner",!1);if(YUI.Env.isServer&&t.enableBrowserUpgradeBanner){var i=this.appContext.request.headers["user-agent"],s=e.BrowserSupport.isUnsupportedBrowser(i),o=e.BrowserSupport.isBot(i),u=e.BrowserSupport.isSharingBot(i);s&&!o&&!u&&this.set("showBrowserUpgradeBanner",!0)}if(!YUI.Env.isServer){var a=e.StorageHelper.getItem("hasDismissedBrowserUpgradeBanner",!0);a&&a==="true"&&this.set("showBrowserUpgradeBanner",!1)}return this.get("container").get("innerHTML")===""&&this.setContainerHTML('<div class="global-nav-content"></div>'),this.appStateParams=t,this.enableMobileNav=t.enableMobileNav||!1,n=this.appContext.getLocation(),t.modelParams&&t.modelParams.apiParams?r=t.modelParams.apiParams:r=n.href,this.searchUrl=new e.SearchUrl(r,this.appContext,t.searchType),this.useGlobalNavRestyle=t.useGlobalNavRestyle,this.appContext.flipper.isFlipped("enable-signed-out-cta-test")&&(this.signedOutTest=!0),this.appContext.flipper.isFlipped("enable-sign-up-interstitial-test")&&this.appContext.lang.toLowerCase()==="en-us"&&(this.signUpInterstitialTest=!0),this.appContext.flipper.isFlipped("enable-sign-up-rail-test")&&this.appContext.lang.toLowerCase()==="en-us"&&!this.appContext.getViewer().signedIn&&!t.isSOHP&&(this.signUpRailTest=!0),this},subviewConfig:{"search-autosuggest-field-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.appContext.flipper.isFlipped("enable-new-autosuggest")}},"autosuggest-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,disabled:function(){return this.enableMobileNav||!this.appContext.flipper.isFlipped("autosuggest2")}},"search-bar-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,disabled:function(){return!this.appContext.flipper.isFlipped("autosuggest")}},"account-menu-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"notifications-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,disabled:function(){return!this.appContext.flipper.isFlipped("notifications-menu")}},"browser-upgrade-banner-view":{requiredToShowOnServer:!0,requiredToShowOnClient:!1,dealbreaker:!1,disabled:function(){return!this.get("showBrowserUpgradeBanner")}},"person-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerSelector:"#content",excludeSelectors:[".c-account-menu"],disabled:function(){return!this.appContext.flipper.isFlipped("enable-hover-account-menu")||!this.appContext.flipper.isFlipped("rebootify-group-discussions-list")}},"group-menu-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,containerSelector:"#content",excludeSelectors:[".c-account-menu"],disabled:function(){return!this.appContext.flipper.isFlipped("enable-hover-account-menu")||!this.appContext.flipper.isFlipped("rebootify-group-discussions-list")}},"mobile-app-upsell-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(t){return!t.isMobile||!e.Views["mobile-app-upsell-view"].shouldShowBanner(this.appContext)}},"signup-rail-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["collapsed"],disabled:function(e){return e.isMobile||!this.signUpRailTest}}},loadState:function(){var t=this,n=this.appContext.getViewer(),r;return n.signedIn?r=this.appContext.getModel("person-models",n.nsid).then(function(e){t.set("viewer",e),t.elementStates=t.setElementStates(t.appStateParams)}):(this.elementStates=this.setElementStates(this.appStateParams),r=e.Promise.resolve()),r},buildContainer:function(){var t={},n;return this.get("viewer")&&(t=e.merge(this.get("viewer").toJSON(),{urls:e.URLHelper.generatePersonUrls(this.get("viewer"))})),n={"account-menu-view":this.subviews["account-menu-view"].get("container"),"browser-upgrade-banner-view":this.subviews["browser-upgrade-banner-view"]?this.subviews["browser-upgrade-banner-view"].get("container"):"","show-browser-upgrade-banner":this.get("showBrowserUpgradeBanner"),showNotificationsMenu:!1,viewer:t,elements:this.elementStates,enableMobileNav:this.enableMobileNav,enableNewAutosugest:this.appContext.flipper.isFlipped("enable-new-autosuggest"),showSmartSearchBar:this.appContext.flipper.isFlipped("autosuggest"),showAutosuggest:!this.enableMobileNav&&this.appContext.flipper.isFlipped("autosuggest2"),searchValue:this.searchUrl.getSearchTerm(),"person-menu-view":this.subviews["person-menu-view"]?this.subviews["person-menu-view"].get("container"):"","group-menu-view":this.subviews["group-menu-view"]?this.subviews["group-menu-view"].get("container"):"","mobile-app-upsell-view":this.subviews["mobile-app-upsell-view"]?this.subviews["mobile-app-upsell-view"].get("container"):"","signup-rail-view":this.subviews["signup-rail-view"]?this.subviews["signup-rail-view"].get("container"):""},n.showAutosuggest?n["autosuggest-view"]=this.subviews["autosuggest-view"].get("container"):n.showSmartSearchBar?n["search-bar-view"]=this.subviews["search-bar-view"].get("container"):n.enableNewAutosugest&&(n["search-autosuggest-field-view"]=this.subviews["search-autosuggest-field-view"].get("container")),this.appContext.flipper.isFlipped("notifications-menu")&&(n["notifications-menu-view"]=this.subviews["notifications-menu-view"].get("container"),n.showNotificationsMenu=!0),this.appContext.flipper.isFlipped("global-nav-restyle")||this.useGlobalNavRestyle?this.setContainerHTML(this.templates("global-nav-restyle")(n)):this.setContainerHTML(this.templates("global-nav")(n)),this},activate:function(){var t=this,n=this.appContext.getViewer().prefs.keyboardShortcutsEnabled,r,i,s,o=this.get("container");i=["photo-page-ad-scrappy-view","sohp-view","products-landing-view","products-marketplace-products-view"],r=this.appContext.flapp.get("activeView").name,n&&this.attachKeyEvent("up:83",this.focusSearch.bind(this)),t.subviews["autosuggest-view"
]&&(this.registerEventHandler(this.subviews["autosuggest-view"].on("open",function(e){t.subviews["account-menu-view"].closeMenu()})),this.registerEventHandler(this.subviews["account-menu-view"].on("open",function(e){t.subviews["autosuggest-view"].close()}))),this.elementStates.search_bar&&!this.appContext.flipper.isFlipped("enable-new-autosuggest")&&(s=o.one(".gn-tools form"),s&&this.registerEventHandler(s.on("submit",this.executeSearch.bind(this))));if(this.appContext.flipper.isFlipped("global-nav-restyle")||this.useGlobalNavRestyle)this.registerEventHandler(o.one(".mobile-nav-toggle").on("click",function(n){e.rapidTracker.beacon(t.name,"mobile-nav-toggle",{action:o.one(".global-nav-restyle").hasClass("menu-open")?"close":"open"}),o.one(".global-nav-restyle").toggleClass("menu-open")}.bind(this))),this.registerEventHandler(o.one(".mobile-search-button").on("click",function(n){e.rapidTracker.beacon(t.name,"mobile-nav-search");var r=this.get("container"),i=r.one(".global-nav-restyle"),s=r.one("#gn-search-field"),o=this.appContext.viewportData.getWidth(),u=37,a=46;i.addClass("search-open"),i.hasClass("menu-open")&&i.removeClass("menu-open"),t.appContext.flipper.isFlipped("enable-new-autosuggest")?(t.fire("parentViewEvent","resize-search-field",o-a),t.fire("parentViewEvent","focus-search-field")):(t.appContext.flipper.isFlipped("autosuggest")&&(s=r.one("#autosuggest-input"),a=42),s.setStyles({width:o-u-a+"px"}).focus())}.bind(this))),this.registerEventHandler(o.one(".mobile-search-close-button").on("click",function(e){o.one(".global-nav-restyle").removeClass("search-open"),t.appContext.flipper.isFlipped("autosuggest")?o.one(".global-nav-restyle #autosuggest-input").set("value",""):t.appContext.flipper.isFlipped("enable-new-autosuggest")?t.fire("parentViewEvent","clear-search-field"):o.one(".global-nav-restyle #gn-search-field").set("value","")}.bind(this))),this.registerEventHandler(e.globalEvents.subscribe("window:resize",function(e){o.one(".global-nav-restyle").removeClass("search-open"),t.appContext.flipper.isFlipped("autosuggest")?o.one(".global-nav-restyle #autosuggest-input").set("value","").setStyles({width:"183px"}):t.appContext.flipper.isFlipped("enable-new-autosuggest")?t.fire("parentViewEvent","resize-search-field"):o.one(".global-nav-restyle #gn-search-field").set("value","").setStyles({width:"183px"})}.bind(this)));return this.appContext.getViewer().signedIn||(this.signedOutTest&&this.registerEventHandler(o.one(".gn-upload .gn-title").on("click",this.signUpAndUpload.bind(this))),i.indexOf(r)<0&&!this.appContext.getUA().isMobileBrowser&&this.signUpInterstitialTest&&this.startInterstitialTimer()),e["autosuggest-experiment"](this.appContext),this},startInterstitialTimer:function(){var t=this,n,r=!1,i;n=e.StorageHelper.getItem("signUpInterstitialSeen"),n?(n=e.moment(n,"x"),i=e.moment().subtract(2,"days"),i>n&&(r=!0)):r=!0,r&&(this.signUpInterstitialTimer=setTimeout(function(){if(!e.OverlayManager.hasOverlay()&&e.config.win.innerWidth>700){var n=new e.Views.SignUpInterstitial({appContext:t.appContext});n.show(),e.StorageHelper.setItem("signUpInterstitialSeen",e.moment().format("x"))}},4e3))},destructor:function(){clearTimeout(this.signUpInterstitialTimer)},signUpAndUpload:function(t){var n=e.url("/upload/"),r=this.intlMessage({intlName:"global-nav.UPLOAD_MODAL_SIGNUP_TITLE"}),i=this.intlMessage({intlName:"global-nav.UPLOAD_MODAL_SIGNUP_MESSAGE"}),s;t.halt(),e.rapidTracker.beacon(this.name,"uploadButtonClick"),s=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-upload",signUpTitle:r,signUpMessage:i,beaconPrefix:"upload"}),s.on("signUpClick",function(t){e.SigninHelper._redirectToSignUp("upload",{postLoginUrl:n})}),s.on("signInClick",function(t){e.SigninHelper._redirectToSignin("upload",{postLoginUrl:n})}),s.show()},focusSearch:function(e){this.appContext.flipper.isFlipped("autosuggest")?this.subviews["search-bar-view"].get("container").one("#autosuggest-input").focus():this.appContext.flipper.isFlipped("enable-new-autosuggest")||this.get("container").one("#gn-search-field").focus()},executeSearch:function(e){var t=this.get("container").one("#gn-search-field").getDOMNode(),n;n=this.searchUrl.createNewSearch(t.value).getURL(),e.halt(),this.appContext.flapp.navigate(n)},setElementStates:function(e){var t={small_logo:!1,you_link:!1,you_menu:!1,contacts_menu:!1,groups_menu:!1,explore_menu:!1,weekly_flickr:!1,create_link:!1,create_menu:!1,upload_link:!1,upload_icon:!1,account_menu:!1,search_bar:!1,tour_link:!1,signup_link:!1,signin_link:!1,pro_upsell:!1,chronic_link:!1,editr_tour_link:!1,use_uh_eyebrow:!1,right_side_signup:!1},n=this.appContext.getViewer();return!this.appContext.flipper.isFlipped("global-nav-restyle")&&!this.useGlobalNavRestyle?(e.isJobs?t.small_logo=!0:e.isPlayr?t.use_uh_eyebrow=!1:e.isEditr?(t.small_logo=!0,t.you_link=!0,t.chronic_link=!0,t.editr_tour_link=!0,t.account_menu=!0,t.use_uh_eyebrow=!1):e.isHome&&!n.signedIn?(t.tour_link=!0,t.signup_link=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.signin_link=!0):n.signedIn?(t.you_menu=!0,t.contacts_menu=!0,t.groups_menu=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.account_menu=!0):(t.tour_link=!0,t.signup_link=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.signin_link=!0),this.get("viewer")&&(this.appContext.flipper.isFlipped("rebootify-stats")||this.get("viewer").getValue("isPro"))&&(t.stats=!0),this.appContext.lang.toLowerCase()==="en-us"&&(t.weekly_flickr=!0),t.create_link=!0,t.set_not_album=!this.appContext.flipper.isFlipped("rename-set-to-album")):(e.isJobs?t.small_logo=!0:e.isPlayr?t.use_uh_eyebrow=!1:e.isEditr?(t.small_logo=!0,t.you_link=!0,t.chronic_link=!0,t.editr_tour_link=!0,t.account_menu=!0,t.use_uh_eyebrow=!1):e.isHome&&!n.signedIn?(t.tour_link=!0,t.signup_link=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.signin_link=!0):n.signedIn?(t.you_menu=!0,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.account_menu=!0):(t.tour_link=!0,t.signup_link=!0
,t.explore_menu=!0,t.upload_link=!0,t.search_bar=!0,t.signin_link=!0),this.get("viewer")&&(this.appContext.flipper.isFlipped("rebootify-stats")||this.get("viewer").getValue("isPro"))&&(t.stats=!0),this.appContext.lang.toLowerCase()==="en-us"&&(t.weekly_flickr=!0),t.create_link=!0,t.set_not_album=!this.appContext.flipper.isFlipped("rename-set-to-album"),this.appContext.flipper.isFlipped("enable-global-nav-upload-icon")&&(t.upload_link=!1,t.upload_icon=!0),this.appContext.flipper.isFlipped("rebootify-tags")?t.show_tags_menu_link=!0:t.show_tags_menu_link=!1,this.signedOutTest&&(t.right_side_signup=!0)),t},onSubviewEvent:function(e,t){t&&e==="mobile-app-upsell-view"&&t[0]==="removeUpsell"&&this.subviews["mobile-app-upsell-view"].destroy({remove:!0})}})},"@VERSION@",{requires:["flickr-view","hermes-template-global-nav","hermes-template-global-nav-restyle","global-nav-css","global-nav-restyle-css","search-url","search-autosuggest-field-view","autosuggest-view","search-bar-view","querystring-parse-simple","querystring-stringify-simple","notifications-menu-view","fluid-css","url-helper","person-menu-view","group-menu-view","autosuggest-experiment","browser-support","fluid-modal-view","signup-modal-view","signup-interstitial-view","signin-helper","storage-helper","mobile-app-upsell-view"],langBundles:["global-nav","common","search"]});
YUI.add("hermes-lang-global-nav",function(e,t){e.Intl.add("hermes/global-nav","en-US",{FLICKR_LOGO_ALT:["Flickr logo. If you click it, you'll go home"],YOUR_PHOTOSTREAM:["Your Photostream"],FOLLOWING:["Following"],PHOTOS_OF:["Photos of"],PHOTOS_FROM:["Photos from"],LIST:["List"],COMMUNITIES:["Communities"],GROUPS_LIST:["Groups List"],SEARCH_GROUPS:["Search Groups"],RECENT_DISCUSSIONS:["Recent Discussions"],CREATE_A_GROUP:["Create a Group"],RECENT_PHOTOS:["Recent Photos"],THE_COMMONS:["The Commons"],GETTY_COLLECTION:["Getty Collection"],GALLERIES:["Galleries"],FLICKR_GALLERIES:["Flickr Galleries"],WORLD_MAP:["World Map"],APP_GARDEN:["App Garden"],THE_WEEKLY_FLICKR:["The Weekly Flickr"],FLICKR_BLOG:["Flickr Blog"],UPLOAD:["Upload"],SIGN_IN:["Sign In"],SEARCH:["Search"],CAMERA_FINDER:["Camera Finder"],RECENT_ACTIVITY:["Recent Activity"],STATS:["Stats"],ORGANIZE:["Organize"],CREATIONS:["Creations"],FIND_FRIENDS:["Find Friends"],GROUPS:["Groups"],PEOPLE:["People"],CAMERAROLL:["Camera Roll"],CREATE:["Create"],UPLOAD_MODAL_SIGNUP_TITLE:["Upload your photos securely and privately!"],UPLOAD_MODAL_SIGNUP_MESSAGE:["Join Flickr to unlock 1,000GB of free photo storage."]})},"@VERSION@",{requires:["intl"]});
