YUI.add("photo-route",function(e){function n(e){n.superclass.constructor.call(this,e)}var t={activity_feed:{backToIntlKey:"BACK_TO_ACTIVITY_FEED",usesWith:!1},album:{backToIntlKey:"BACK_TO_ALBUM",usesWith:!0},commons:{backToIntlKey:"BACK_TO_COMMONS",usesWith:!1},contacts_list:{backToIntlKey:"BACK_TO_CONTACTS_LIST",usesWith:!1},explore:{backToIntlKey:"BACK_TO_EXPLORE",usesWith:!0},favorites:{backToIntlKey:"BACK_TO_FAVORITES",usesWith:!0},gallery:{backToIntlKey:"BACK_TO_GALLERY",usesWith:!0},groups:{backToIntlKey:"BACK_TO_GROUPS"},group:{backToIntlKey:"BACK_TO_GROUP",usesWith:!0,withParamName:"pool/with"},map:{backToIntlKey:"BACK_TO_MAP",usesWith:!1},photostream:{backToIntlKey:"BACK_TO_PHOTOSTREAM",usesWith:!0},profile:{backToIntlKey:"BACK_TO_PROFILE",usesWith:!1},search:{backToIntlKey:"BACK_TO_SEARCH",usesWith:!1},shares:{backToIntlKey:"BACK_TO_SHARED_PHOTOS",usesWith:!1},tags:{backToIntlKey:"BACK_TO_TAG",usesWith:!1},tag:{backToIntlKey:"BACK_TO_TAG",usesWith:!1}};e.Routes[this.name]=n,e.extend(n,e.FlickrRoute,{langBundles:this.details.langBundles,run:function(t,n){var r=this,i=t.params.nsid_or_path_alias,s=t.params.photo_id,o=t.params.context,u=t.params.lightbox==="lightbox",a=t.params.comment_id,f={id:s},l=t.query||{},c=!1,h;return a&&n.redirect(t.url.replace("/"+a,"")+"#"+a),e.TypeValidator.matches.nsid(i)?f.userId=i:f.pathAlias=i,h=r.parseContext(o,i,t),h&&h.params&&h.params.isSharedEntity?this.appContext.setGPCredentials({gp_code:h.params.gpCode,gp_owner:h.params.gpOwner,share_code:h.params.gpCode}):this.appContext.setGPCredentials(null),l&&l.cr!==undefined&&(c=!0),this.appContext.flipper.isFlipped("get-context-photos-in-photo-page-route")&&(h&&h.params&&h.modelName&&h.modelName!=="photostream-models"?f.context=o:f.context="photostream"),this.appContext.getModel("photo-models",f).then(function(s){var a,f,l,p,d,v,m,g,y,b,w;v=u?"photo-page-lightbox-scrappy-view":"photo-page-scrappy-view",m="scrolling",g="photo-page-ad-scrappy-view",y="scrolling",a=r.verifyPhotoIsViewable(s),d=r.detectRouteErrors(a);if(d.length)return r.displayRouteErrors(t,d);f=r.verifyPhotoIsOwnedByPerson(s,i),w=f,d=r.detectRouteErrors(f);if(d.length)return r.displayRouteErrors(t,d);var E=6,S=12;r.appContext.forceServerRender&&(E=2,S=0),r.detectBackToDestination(t,{person:i,photoId:a,context:o}),b=r.getBackToData();if(d.length)return r.displayRouteErrors(t,d);h.modelName==="photostream-models"&&(h.params.id=e.Models[h.modelName].buildCompoundId(f,h.params.orderBy,h.params.viewAs),w=h.params.id,delete h.params.pathAlias);if(r.appContext.adManager.isEnabled()&&r.appContext.adManager.adNext()&&!u&&!t.UA.isMobileBrowser){p=r.appContext.adManager.getAdJSON();if(p&&e.Lang.isObject(p))return l=p.brand||"",{view:g,params:{ad:!0,photoId:a,nsid:f,photostreamId:w,context:h,backToURL:b.path,hideBackToLink:c,entryTypeIntlKey:b.backToIntlKey,numberOfPositionsToPreFetch:E,numberOfPositionsToRefetchAt:S},title:l,layout:y,fluid:!0};e.Flog.fatal("Could not extract brand name from brand payload",{ad:p})}var x=!0,T=!1;return r.appContext.flipper.isFlipped("enable-new-mobile-photo-page")&&r.isProcessedAsMobileRequest(t,n)&&(v="mobile-photo-page-view",x=!1,T=!0),t.UA.isFacebook&&(v="photo-page-meta-tags-only",m="opengraph",x=!1),{view:v,params:{photoId:a,nsid:f,photostreamId:w,context:h,backToURL:b.path,hideBackToLink:c,entryTypeIntlKey:b.backToIntlKey,fullscreen:u,numberOfPositionsToPreFetch:E,numberOfPositionsToRefetchAt:S},title:s.getValue("title")||"Untitled",layout:m,fluid:!0,darkLoader:x,isMobile:T}},function(n){var i="Couldn't load photo page";t.UA.isMobileBrowser&&r.appContext.flipper.isFlipped("enable-new-mobile-photo-page")&&(i="Couldn't load mobile photo page"),n.message&&(i+=": "+n.message);if(n.code===1)return e.fletrics.increment("route.photo.route.404"),r.displayRouteErrors(t,new e.RouteError(404,i));if(n.code===2&&!r.appContext.getViewer().signedIn)return e.Promise.resolve({redirect:"/signin/?redir="+t.url});if(n.fatal)throw e.fletrics.increment("route.photo.route.500"),n;return e.fletrics.increment("route.photo.route.404"),r.displayRouteErrors(t,new e.RouteError(404,i))})},verifyPhotoIsViewable:function(t){var n=t.getValue("id");return e.TypeValidator.matches.photoId(n)?n:new e.RouteError(404,this.intlMessage({intlName:"photo-page-scrappy.NO_PHOTO_WITH_THAT_ID",photoId:n}))},verifyPhotoIsOwnedByPerson:function(t,n){var r=t.getValue("id"),i=e.TypeValidator.matches.nsid(n);return n===t.getValue("owner").getValue(i?"id":"pathAlias")?t.getValue("owner").getValue("id"):new e.RouteError(404,"Photo "+r+" is not owned by "+n)},parseContext:function(t,n,r){return t=t||"photostream",e.URLHelper.parseContextURL(t,n,this.appContext)},detectBackToDestination:function(t,n){var r,i,s,o,u;if(e.config.flickr.homerun&&(e.config.flickr.ycParam||t.query&&t.query.yc)){u=e.config.flickr.ycParam?e.config.flickr.ycParam:t.query.yc;if(e.config.flickr.homerun.yc.indexOf(u.replace(/https?\:\/\//,""))!==-1)return this.setBackToData({name:"Yahoo"},u.match(/https?:/)?u:"https://"+u,n)}if(YUI.Env.isServer){r=t.headers.referrer||t.headers.referer;if(/^https?:\/\/[^\/]*(?:flickr\.com|flic\.kr)(?:$|\/)/.test(r)){if(n.context)return i=e.URLHelper.getContextEntity(n.context,n.person),this.setBackToData(e.URLHelper.getSiteSectionByName(i.type),i.url,n);r="/"+r.split("/").slice(3).join("/"),o=e.URLHelper.getSiteSectionByURL(r);if(o)return this.setBackToData(o,o.match,n)}else if(n.context)return i=e.URLHelper.getContextEntity(n.context,n.person),this.setBackToData(e.URLHelper.getSiteSectionByName(i.type),i.url,n)}else{r=this.appContext.getPreviousURL(),s=this.appContext.flapp.get("activeView");if(["photo-page-scrappy-view","photo-page-lightbox-scrappy-view","minimal-photo-page-view","photo-page-ad-scrappy-view"].indexOf(s.name)>-1){if(s.backToURL){o=e.URLHelper.getSiteSectionByURL(s.backToURL);if(o)return this.setBackToData(o,s.backToURL,n)}}else if(r!==e.config.win.location.pathname){o=e.URLHelper.getSiteSectionByURL(r);if(o)return this.setBackToData(o,o.match,
n)}}return this.setBackToData(null,null,n)},setBackToData:function(r,i,s){var o=YUI.Env.isServer?this:n,u,a,f;u=r?t[r.name]:null,u||(r=e.URLHelper.getSiteSectionByName("photostream"),i="/photos/"+s.person,u=t.photostream),a=e.merge(u,r),f=a.withParamName||"with",i=this.stripPathSuffixes(i),a.usesWith&&(i=i.replace(/([^\/])$/,"$1/"),i+=f+"/"+s.photoId),i[i.length-1]!=="/"&&i.indexOf("?")===-1&&(i+="/"),o._entryType=a.name,o._entryPath=i,o._backToIntlKey=a.backToIntlKey},getBackToData:function(){var e=YUI.Env.isServer?this:n;return{type:e._entryType,path:e._entryPath,backToIntlKey:e._backToIntlKey}},stripPathSuffixes:function(e){return e=e.replace(/\/+/g,"/"),e=e.replace(/\/with\/\d+\/?$/,"/"),e=e.replace(/\/in\/[^\/]+\/?$/,"/"),e=this.filterURL(e,function(e){var t;if(e.length>=3)for(t=2;t<e.length;t++)e[t].match(/page\d+/)&&(e.splice(t,1),t--);return e}),e=this.filterURL(e,function(e){var t;if(e[0]==="groups"&&e.length>=3)for(t=2;t<e.length;t++)e[t]==="pool"&&(e.splice(t,1),t--);return e}),e},filterURL:function(e,t){var n,r;return r=e.split("/").filter(function(e){return!!e}),n="/"+t(r).join("/"),n[n.length-1]!=="/"&&e.indexOf("?")===-1&&(n+="/"),n}}),e.mix(n.prototype,e.Localizable),e.mix(n.prototype,e.Seo)},"@VERSION@",{requires:["flog","flickr-route","type-validator","url-helper","fletrics","localizable","seo"],optional:["photo-models","photostream-models","photo-page-scrappy-view","photo-page-lightbox-scrappy-view","mobile-photo-page-view"],langBundles:["photo-page-scrappy","common","attribution"]});
YUI.add("photo-well-view",function(e){var t=1,n=5;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.photoId=t.photoId,this.contextData=e.clone(t.context,!0),this.isAd=!!t.ad,this.firstLoad=!!t.firstLoad,this.publisherUrl=t.publisherUrl,t.isFluid=!0,t.isOnDark=!0,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},subviewConfig:{"photo-well-media-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"photo-sidebar-toggle-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1},"attribution-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["is-real-fullscreen","photo-attribution"]},"photo-sidebar-actions-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["is-real-fullscreen"],disabled:function(){return this.appContext.experiments.fullscreen.disableRealFullscreenButtons()}},"people-notes-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:!0}},buildContainer:function(){var e=this,t,n="",r,i=0,s,o,u=".navigate-prev",a=".navigate-next",f,l,c,h;return this.firstLoad||(this.subviews["photo-sidebar-actions-view"]&&this.subviews["photo-sidebar-actions-view"].get("container").addClass("is-hidden"),this.subviews["photo-sidebar-toggle-view"]&&this.subviews["photo-sidebar-toggle-view"].get("container").addClass("is-hidden")),this.appContext.experiments.fullscreen.getMode()?this.subviews["attribution-view"]&&(YUI.Env.isServer||this.subviews["attribution-view"].get("container").removeClass("is-always-hidden"),!this.firstLoad&&this.contextData.modelName!=="photoList-models"&&this.contextData.modelName!=="explore-models"&&this.subviews["attribution-view"].get("container").addClass("is-hidden"),n=this.subviews["attribution-view"].get("container")):this.subviews["attribution-view"]&&(this.subviews["attribution-view"].get("container").addClass("is-always-hidden"),n=this.subviews["attribution-view"].get("container")),this.get("contextModel")&&(r=this.get("contextModel").getValue("photoContextList").getList(),r.length>2&&r.some(function(t){return i++,t.getValue("id")===e.photoId})&&(s=r.slice(i-2,i-1),o=r.slice(i,i+1),s&&s.length>0&&(f=e.setupNavLink(s[0],u,"previous"),s[0].getValue("owner")&&(s[0].getValue("title").trim()===""?c=e.intlMessage({intlName:"common.UNTITLED"}):c=s[0].getValue("title"),c+=" | "+e.intlMessage({intlName:"common.BY_USER",user:s[0].getValue("owner").getValue("username")}))),o&&o.length>0&&(l=e.setupNavLink(o[0],a,"next"),o[0].getValue("title").trim()===""?h=e.intlMessage({intlName:"common.UNTITLED"}):h=o[0].getValue("title"),h+=" | "+e.intlMessage({intlName:"common.BY_USER",user:o[0].getValue("owner").getValue("username")})))),t=this.templates("photo-well")({"photo-well-media-view":this.subviews["photo-well-media-view"].get("container"),"is-video":this.get("photo").getValue("isVideo"),"is-hidden":(YUI.Env.isServer||!this.firstLoad)&&!f&&!l,"prev-is-not-clickable":!f,"next-is-not-clickable":!l,"prev-url":f,"next-url":l,"prev-title":c,"next-title":h,"is-ad":this.isAd,"photo-sidebar-toggle-view":this.subviews["photo-sidebar-toggle-view"]?this.subviews["photo-sidebar-toggle-view"].get("container"):"","opt-out-enabled":this.appContext.experiments.optOut.enabled(),"photo-sidebar-actions-view":this.subviews["photo-sidebar-actions-view"]?this.subviews["photo-sidebar-actions-view"].get("container"):"","attribution-view":n,"people-notes-view":this.subviews["people-notes-view"]?this.subviews["people-notes-view"].get("container"):"",enableZoom:this.appContext.flipper.isFlipped("enable-scrappy-zoom")}),this.setContainerHTML(t),YUI.Env.isServer&&(this.serverWidth=this.subviews["photo-well-media-view"].serverWidth,this.serverHeight=this.subviews["photo-well-media-view"].serverHeight),this},loadState:function(){var t=this,n=[];return n.push(this.appContext.getModel("photo-models",this.photoId).then(function(e){if(!e)throw new Error("[photo-well-view] Invalid photoModel returned from getModel");t.set("photo",e)})),this.contextData&&this.contextData.modelName&&this.contextData.params&&n.push(this.appContext.getModelRegistry(this.contextData.modelName).then(function(e){var n;if(e){n=e.attributeSearch(t.contextData.params);if(n&&n.length&&e.exists(n[0]))return t.appContext.getModel(t.contextData.modelName,n[0]).then(function(e){e&&t.set("contextModel",e)})}}).then(null,function(){return"whatever"})),e.Promise.all(n)},setLinkAsAdFriendly:function(e){var t=e.currentTarget;t.hasClass("navigate-next")?this.appContext.adManager.setAdCouldBeShown(!0,"next",t.getAttribute("href")):this.appContext.adManager.setAdCouldBeShown(!0,"previous",t.getAttribute("href"))},animateNavigation:function(){var t=e.all(".navigate-target"),n=this.get("container"),r=n.one(".photo-sidebar-toggle-view"),i=n.one(".attribution-view"),s=1500,o=250,u=!1,a=!1,f,l=!0,c=this;s=(s-500)/2,u=!0,a=this.appContext.experiments.fullscreen.getMode(),this.registerEventHandler(this.get("container").on("mousemove",e.betterThrottle(function(e){f=n.one(".photo-sidebar-actions-view"),t&&l&&t.removeClass("is-hidden"),u&&l&&(f&&f.removeClass("is-hidden"),r&&r.removeClass("is-hidden"),i&&i.removeClass("is-hidden")),clearTimeout(c.movingTimeout),clearTimeout(c.initialTimeout),l=!0,c.followViewOpen||(c.movingTimeout=setTimeout(c.hideUI.bind(c),s*2))},o))),!this.firstLoad&&this.contextData.modelName!=="photoList-models"&&this.contextData.modelName!=="explore-models"&&(l=!1),c.initialTimeout=setTimeout(function(){l=!0,f=n.one(".photo-sidebar-actions-view"),t&&c.firstLoad&&t.addClass("is-hidden"),u&&l&&(f&&f.addClass("is-hidden"),r&&r.addClass("is-hidden"),i&&i.addClass("is-hidden"))},s*2)},hideUI:function(){var e=this.get("container"),t=e.one(".photo-sidebar-actions-view"),n=e.one(".photo-sidebar-toggle-view"),r=e.one(".attribution-view");t&&t.addClass("is-hidden"),n&&n.addClass("is-hidden"),r&&r.addClass("is-hidden")},onSubviewEvent:function(e,t){var n=1500;n=(n-500)/2,e==="attribution-view"&&
t[0]==="isOpen"?(this.followViewOpen=!0,clearTimeout(this.movingTimeout),clearTimeout(this.initialTimeout)):e==="attribution-view"&&t[0]==="isClosed"&&(this.followViewOpen=!1,this.movingTimeout=setTimeout(this.hideUI.bind(this),n*2))},activate:function(){var r=this,i=this.contextData,s=this.get("container"),o=0,u,a,f,l,c=".navigate-prev",h=".navigate-next";return YUI.Env.isServer||(a=e.getLocation(),f=a.protocol,l=a.hostname,r.appContext.getModel(i.modelName,i.params).then(function(e){r.set("contextModel",e)},function(t){if(!t.getModelFailure&&t.code!==1||i.modelName==="photostream-models")throw e.all(c).hide(),e.all(h).hide(),t;return r.contextData.modelName="photostream-models",r.contextData.params.id=r.get("photo").getValue("owner").getValue("nsid"),r.appContext.getModel("photostream-models",r.contextData.params).then(function(e){r.set("contextModel",e)})}).then(function(){var t=r.get("contextModel").getValue("photoContextList"),n=t.getList(),s,u,a,p,d;return n.length>2&&n.some(function(e){return o++,e.getValue("id")===r.photoId})&&(u=n.slice(o-2,o-1),a=n.slice(o,o+1),u&&u.length>0&&(p=r.setupNavLink(u[0],c,"previous"),p&&(r.updateNavLinks(c,f,l,p),r.get("container").all(c).removeClass("no-click"))),a&&a.length>0&&(d=r.setupNavLink(a[0],h,"next"),d&&(r.updateNavLinks(h,f,l,d),r.get("container").all(h).removeClass("no-click")))),s=e.merge(i.params,{photoId:r.photoId,numNext:10,numPrev:10}),t.getContext(s)}).then(function(i){function s(s,o){var u=r.get("container").all(s),a,c,h,p,d,v,m=i&&i[o]&&i[o].length;if(!u.size())return;if(!m){u.remove();return}u.removeClass("no-click"),a=r.setupNavLink(i[o][0],s,o);if(r.isAd)h=r.appContext.adManager.origin,o===h.arrow?(u.setAttribute("href",h.url),u.removeClass("is-hidden")):(u.setAttribute("href",a),u.removeClass("is-hidden"));else{r.updateNavLinks(s,f,l,a),c=r.subviews["photo-well-media-view"].getCanvasSize();for(v=0;v<n;v++){if(!i[o][v])break;p=i[o][v].getSizeToFit(c,{includeSizes:["sq","q","t","s","n"]}),p&&p.url&&(d=new Image,d.src=p.url)}for(v=0;v<t;v++){if(!i[o][v])break;p=i[o][v].getSizeToFit(c),p&&p.url&&(d=new Image,e.config.win.LH.mark("mark_time_to_load_photo_only_start"),d.onload=function(){e.config.win.LH.mark("mark_time_to_load_photo_only"),e.config.win.LH.measure("time_to_load_photo_only",{startMark:"mark_time_to_load_photo_only_start",endMark:"mark_time_to_load_photo_only"})},d.src=p.url)}}}r.appContext.adManager.updateContext({prev:i.previous[0],current:r.get("photo"),next:i.next[0],type:r.contextData.modelName}),s(h,"next"),s(c,"previous"),r.animateNavigation(),r.isAd&&r.appContext.adManager.markAdAsSeen()},function(e){if(e.notInContext||e.code===99)return r.get("contextModel").setValue("photoContextList",[]),r.contextData.modelName="photostream-models",r.contextData.params.id=r.get("photo").getValue("owner").getValue("nsid"),r.activate();throw e}).then(null,function(t){e.Flog.warn("There was a problem initializing the next/previous controls.",t&&t.message?t.message:t,t&&t.stack?t.stack:"")}),this.attachKeyEvent("down:37,75,39,74",r.handlePrevNextKeys.bind(r)),this.get("photo").getValue("isOwner")||this.appContext.getViewCounter().queue(this.get("photo").getValue("id"),this.publisherUrl||this.appContext.getReferrer())),s&&s.one(".feedback-widget button")&&(this.registerEventHandler(s.one(".feedback-widget button").on("mousedown",r.handleFeedbackClick,r)),this.setupFeedbackDropdown(),e.Env.isServer||s.all("input[name=redirect_url]").setAttribute("value",e.config.win.location.pathname)),u={":ad":r.setLinkAsAdFriendly},r.attachEvents(u),this},setupNavLink:function(t,n,r){var i=this.get("container").all(n),s,o;if(!t&&i.size()){i.remove();return}s=t,o=e.URLHelper.getPhotoPage({photoId:s.getValue("id"),pathAlias:s.getValue("owner").getValue("pathAlias"),contextSuffix:this.get("contextModel").getValue("urlSuffix"),lightbox:this.appContext.experiments.fullscreen.getMode()});if(!o||o==="#"){e.Flog.warn("[photo-well-view] Invalid next/prev URL:",o),i.remove();return}return o},updateNavLinks:function(e,t,n,r){var i=this.get("container").all(e);i.setAttribute("href",t+"//"+n+r),this.firstLoad&&i.removeClass("is-hidden")},destructor:function(){clearTimeout(this.movingTimeout),clearTimeout(this.initialTimeout),this.movingTimeout=null,this.initialTimeout=null},setupFeedbackDropdown:function(){var t=this.get("container"),n,r,i;if(this.appContext.flipper.isFlipped("buckets"))switch(this.appContext.buckets.photo_page){case"bucket1":i="https://yahoo.uservoice.com/forums/230780-flickr-photo-page-beta/";break;case"bucket2":i="https://yahoo.uservoice.com/forums/230781-flickr-photo-page-beta-2/";break;case"bucket3":i="https://yahoo.uservoice.com/forums/230782-flickr-photo-page-beta-3/";break;case"bucket4":i="https://yahoo.uservoice.com/forums/230783-flickr-photo-page-beta-4/";break;case"bucket5":i="https://yahoo.uservoice.com/forums/230785-flickr-photo-page-beta-5";break;case"bucket6":i="https://yahoo.uservoice.com/forums/230786-flickr-photo-page-beta-6";break;case"bucket7":i="https://yahoo.uservoice.com/forums/230787-flickr-photo-page-beta-7/";break;case"bucket8":i="https://yahoo.uservoice.com/forums/230788-flickr-photo-page-beta-8/";break;default:i="https://yahoo.uservoice.com/forums/224533-flickr-photo-page-beta"}else i="https://yahoo.uservoice.com/forums/224533-flickr-photo-page-beta";r=[{buttonMarkup:new e.Handlebars.SafeString('<a href="'+i+'" data-track="helpFeedbackUserVoiceClick" class="ui-button" target="_blank"><span>Feedback</span></a>')},{buttonMarkup:new e.Handlebars.SafeString('<a href="//'+e.config.flickr.url.host+'/help/photos/#167391143" data-track="helpFeedbackFAQClick" class="ui-button" target="_blank"><span>FAQs</span></a>')}],n=this.templates("reboot-welcome-dialog-content")({"opt-out-enabled":this.appContext.experiments.optOut.enabled()}),this.appContext.experiments.optOut.enabled()&&r.push({buttonMarkup:new e.Handlebars.SafeString(this.templates("photo-opt-out")({"redirect-url":e.config.win.location.pathname}))}),this.feedbackDialog=
e.Views.dialog.getNewInstance("dialog-cta",{attrs:{title:"Welcome to the beta of the new photo page!",hideConfirmButton:!0,verticalButtonList:!0,additionalButtons:r},content:n,parent:this,rootEl:t.ancestor()}),this.feedbackDialog.get("container").addClass("welcome-dialog")},handleFeedbackClick:function(t){if(t.target.ancestor(".ui-dialog",!0))return;t.halt(),this.feedbackDialog.toggle(),e.rapidTracker.beacon(this.name,"helpFeedbackMenuClick")},handlePrevNextKeys:function(t){var n=this,r,i,s,o=50;if(t.button===37||t.button===75)i=".navigate-prev",s="previous",e.rapidTracker.beacon(this.name,"prevPhotoKeyPress");else if(t.button===39||t.button===74)i=".navigate-next",s="next",e.rapidTracker.beacon(this.name,"nextPhotoKeyPress");i&&n.get("container").one(i)&&(t.preventDefault(),r=n.get("container").one(i).getAttribute("href"),r&&r!=="#"&&(n.keyboardNavigation&&n.keyboardNavigation.url&&r===n.keyboardNavigation.url&&(new Date).getTime()-n.keyboardNavigation.time<o?e.Flog.debug("[photo-well-view] Ignoring duplicate keyboard navigation within "+o+"ms",r):(n.keyboardNavigation={url:r,time:(new Date).getTime()},this.appContext.adManager.setAdCouldBeShown(!0,s,r),n.appContext.flapp.navigate(r))))},handleContextMenu:function(e){e.preventDefault(),this.fire("subviewViewEvent","rightClickPhoto")}})},"@VERSION@",{requires:["yui-throttle","flickr-view","hermes-template-photo-well","photo-well-css","url-helper","better-throttle","hermes-template-reboot-welcome-dialog-content","hermes-template-photo-opt-out","flog"],optional:["photo-well-media-view","photo-models","photo-route"],langBundles:["common"]});
